<h1>フォロワー</h1>

<%# フォロワーユーザ一覧 %>
<% @users.each do |user| %>

  <table>
    <tr>
      <td>
        <%= attachment_image_tag user, :profile_image, :fill, 30, 30, fallback: "noimage.png",size:'30x30' %>
      </td>
      <td>
        <%= user.name %>さん
      </td>
      <%# カレントユーザ以外はフォローボタンを表示 %>
      <% if user_signed_in? %>
        <% if current_user != user %>
          <% if current_user.following?(user) %>
            <td>
              <%= form_for(current_user.active_relationships.find_by(followed_id: user.id),
                     html: { method: :delete }) do |f| %>
                <%= f.submit "Unfollow" %>
              <% end %>
            </td>
          <% else %>
            <td>
              <%= form_for(current_user.active_relationships.build) do |f| %>
                <%= hidden_field_tag :followed_id, user.id %>
                <%= f.submit "Follow" %>
              <% end %>
            </td>
          <% end %>
        <% end %>
      <% end %>
    </tr>
  </table>

<% end %>